#!/usr/bin/env bash

# Copyright 2017, Dawid Kurek, <dawikur@gmail.com>

fileCsv=$(mktemp)

echo "[ Start ]"

echo "Temporary file: ${fileCsv}"

echo "[ Mkdir ]"
  if [ ! -d build ]; then
    mkdir build || exit 1
  fi

echo "[ Building..."; (
  cd build || exit 1
  cmake .. -DCMAKE_BUILD_TYPE=Release -DBENCHMARK=ON || exit 1
  cmake --build . || exit 1
) || exit 1; echo "Builded ]"

echo "[ Running..."
  ./build/test/benchmark/lel_benchmark --outputTable "${fileCsv}"
echo "Tests done ]"

echo "[ Parsing Csv"
  tokens=$(./script/benchmark/parse "${fileCsv}")
echo "Csv Parsed ]"

echo "[ Copy csv file ]"
cp "${fileCsv}" "res/benchmark/dataRaw"

echo "[ Stop ]"

